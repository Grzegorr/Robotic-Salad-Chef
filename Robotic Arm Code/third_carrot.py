from pyfirmata import Arduino,SERVO, util
import serial
from subprocess import call
import numpy as np
import rtde_receive
import rtde_control
from time import sleep
import time
import pyfirmata
pos = None
pos1 = None
rtde_c = None
rtde_r = None
ardu = None

#a commment
#a comment back
   
 
del rtde_c
del rtde_r
del ardu 


rtde_c = rtde_control.RTDEControlInterface("169.254.141.189")
# import serial library
rtde_r = rtde_receive.RTDEReceiveInterface("169.254.141.189")

ardu = serial.Serial('COM7', 9600)




   
# pos=rtde_r.getActualTCPPose()


# The Home Position for the robot

def Home_pos():
    PosH = [-0.18057158426498476,
            -0.3022378789949078,
            0.5859861295066575,
            0.8950429526719466,
            1.4497796077524545,
            -1.536645554501681]
    rtde_c.moveL(PosH, 0.1, 0.1)
    
def open_griper():
    command =120    # query servo position
    # write position to serial port
    ardu.write(str(command).encode())
    # read serial port for arduino echo
    reachedPos = str(ardu.readline())
    print(reachedPos)
def close_griper():
    command =60    # query servo position
    # write position to serial port
    ardu.write(str(command).encode())
    # read serial port for arduino echo
    reachedPos = str(ardu.readline())
    print(reachedPos)
    
    


# --------------------------------------------------------------
# -------------------Opening the FryCutter ----------------------
# ..................................................................
def Fry_Open():
    Home_pos()

    # 1.
    pospf01 = [-0.31602477825281367,
            -0.3560711154252207,
            0.6571846678527349,
            1.0317849844522111,
            1.4034986943921526,
            -1.6789882542554257]

    rtde_c.moveL(pospf01, 0.1, 0.1)

# 2.

    pospf02 = [-0.3348006923176778,
            -0.3670095775954392,
            0.6513270346325264,
            0.3731924145784219,
            1.5928049786692864,
            -1.4216548374481792]

    rtde_c.moveL(pospf02, 0.1, 0.1)


# 3.

    pospf03 = [-0.3347993987214292,
           -0.36703478613757606,
           0.4625001880794415,
           0.37322002524017894,
           1.59281002800546,
           -1.421448859969537]

    rtde_c.moveL(pospf03, 0.1, 0.1)

# 4.

    pospf04 = [-0.3279586792251454,
           -0.3825794422836312,
           0.5478526982370058,
           0.2785143205562605,
           1.6145801095662429,
           -1.1109127755721475]

    rtde_c.moveL(pospf04, 0.1, 0.1)


# 5.

    pospf05 = [-0.25356820867780094,
           -0.39270594086994265,
           0.44570854333502796,
           0.05395754842787711,
           1.5904039303173316,
           -1.177725406857681]

    rtde_c.moveL(pospf05, 0.1, 0.1)

# 6.

    pospf06 = [-0.14787136657517627,
           -0.4052604420599455,
           0.4580321020439976,
           -0.1894998875972003,
           1.4942595273667887,
           -1.168326073212194]

    rtde_c.moveL(pospf06, 0.1, 0.1)

# 7.

    pospf07 = [-0.13988433819571783,
           -0.4127400456205574,
           0.4307331146719998,
           -0.1858640420956789,
           1.4934234828801236,
           -1.1393478317609678]
    rtde_c.moveL(pospf07, 0.1, 0.1)

# 8.

    pospf08 = [-0.10384487954073868,
           -0.4095955878223732,
           0.5134029602000576,
           -0.3281605170526433,
           1.4875422097903674,
           -1.028816191306323]
    rtde_c.moveL(pospf08, 0.1, 0.1)

# 9.

    pospf09 = [-0.10618193440217841,
           -0.4134801893404255,
           0.4981702144243994,
           -0.2753159045912518,
           1.4721162998737631,
           -1.0776538030181737]
    rtde_c.moveL(pospf09, 0.1, 0.1)


# 10.

    pospf10 = [-0.1656095175825817,
           -0.5426163840280959,
           0.4621490060820639,
           1.1249397356195119,
           1.3755619907447858,
           -1.5695768235681453]
    rtde_c.moveL(pospf10, 0.1, 0.1)

# 11.

    pospf11 = [-0.3374034673932329,
           -0.4944189331664664,
           0.41154961093385434,
           1.4991947022870042,
           1.349078502837459,
           -1.6792718571825487]
    rtde_c.moveL(pospf11, 0.1, 0.1)

# 12.

    pospf12 = [-0.3267993717397349,
           -0.4288295594364855,
           0.4932832337845104,
           1.4227451388405468,
           1.2335829509155418,
           -1.800104075360167]
    rtde_c.moveL(pospf12, 0.1, 0.1)

    Home_pos()

# --------------------------------------------------------------
# ------------------ Closing  the FryCutter ----------------------
# ..................................................................

def Fry_close():
    close_griper()
    Home_pos()
# 0.

    poscf00 = [-0.06752564098164716,
           -0.26038240007770436,
           0.6169281589653968,
           -0.21714873212006358,
           1.4882067968828079,
           -1.0692113283350653]
    rtde_c.moveL(poscf00, 0.1, 0.1)


# 1.

    poscf01 = [-0.1405881984918288,
           -0.4073157676208122,
           0.6227171461776919,
           -0.22150532134688808,
           1.6127698935233044,
           -1.1516935667456578]
    rtde_c.moveL(poscf01, 0.1, 0.1)


# 2.

    poscf02 = [-0.11736051401540998,
           -0.4027351140517822,
           0.6172799947068575,
           -0.4325415484747301,
           1.5797867755361807,
           -1.0556363891565637]
    rtde_c.moveL(poscf02, 0.1, 0.1)


# 3.

    poscf03 = [-0.11757727628976833,
           -0.40314493684628283,
           0.429972435457718,
           -0.4280467980073058,
           1.5807282962786977,
           -1.0598506800860072]
    rtde_c.moveL(poscf03, 0.1, 0.1)


# 4.

    poscf04 = [-0.08689075918626626,
           -0.5048753886277959,
           0.5344017373653535,
           0.7105330268102811,
           1.8183185466796592,
           -1.6507405800062005]
    rtde_c.moveL(poscf04, 0.1, 0.1)

# 5.

    poscf05 = [-0.08692941248859941,
           -0.5048727728140305,
           0.4976842408508576,
           0.7105696847200207,
           1.8182976816258294,
           -1.6508331589488385]
    rtde_c.moveL(poscf05, 0.1, 0.1)

# 6.

    poscf06 = [-0.3281358249089299,
           -0.5048675291548844,
           0.49767945389833107,
           0.7107155559377419,
           1.8183615012890513,
           -1.6508367239426143]
    rtde_c.moveL(poscf06, 0.1, 0.1)

# 7.

    poscf07 = [-0.3504649403309558,
           -0.504813078159163,
           0.5557469666765842,
           0.7103228706415385,
           1.8181938406977194,
           -1.6510914172469164]
    rtde_c.moveL(poscf07, 0.1, 0.1)

# 8.

    poscf08 = [-0.35047813604866546,
           -0.5047843926346082,
           0.42408530992798565,
           0.7104940133809102,
           1.8181456440862371,
           -1.6510344875487963]
    rtde_c.moveL(poscf08, 0.1, 0.1)

    Home_pos()

def ing_delivary():
    posD01 = [-0.30628314622134956,
     -0.3771741616444723,
     0.41015468721250053,
     -0.6181224861331659,
     -1.5331134891264817,
     0.7436561452442694]
    rtde_c.moveL(posD01, 0.1, 0.1)
    
    posD02 = [-0.2091745393702839,
     -0.4801863601208329,
     0.47208124215410335,
     -0.5627367240818989,
     -1.5234995325259995,
     0.6421795016029331]
    rtde_c.moveL(posD02, 0.1, 0.1)
    
    open_griper()
    
    posD03 = [-0.2757710790332018,
     -0.4801944916135389,
     0.47174617747570013,
     -0.5627177171484792,
     -1.5234920090756352,
     0.6422078408486804]
    rtde_c.moveL(posD03, 0.1, 0.1)
    posD04 = [-0.2757678251271423,
     -0.32542337311373304,
     0.4717691885340995,
     -0.5627090342728871,
     -1.5234668985176008,
     0.6422368369500469]
    rtde_c.moveL(posD04, 0.1, 0.1)
    
     

#  Carrot picking
def First_Carrot_picking():
    
    #0
    
    
    posCaminus1 =  [-0.2714719456374815,
       -0.2407974540920099,
       0.5335635628244908,
       0.9330269811853579,
       -1.7347533749867792,
       1.720962790375419]
    rtde_c.moveL(posCaminus1, 0.1, 0.1)
  
    
    
    open_griper()
    #1 picking the first carrot
    posCa01 = [-0.24766236378363862,
     -0.20070583756851207,
     0.6700391343851001,
     0.9329823804139694,
     -1.7347264182279218,
     1.7209087975102504]
    rtde_c.moveL(posCa01, 0.1, 0.1)
    
    close_griper()
    
    posCa02 = [-0.24765085722884256,
     -0.2006715675131316,
     0.5416518744917878,
     0.933048150430117,
     -1.7346561350780505,
     1.7209780183166001]
    rtde_c.moveL(posCa02, 0.1, 0.1)
    
    posCa03 = [-0.2083130476310146,
     -0.25869170483365356,
     0.4897825002819879,
     -0.6056643336535551,
     -1.515148801314544,
     0.7150208495155058]
    
    rtde_c.moveL(posCa03, 0.1, 0.1)
    ing_delivary()
    
   
    
def Second_Carrot_picking():
       
       posCaminus1 =  [-0.336234891594495,
        -0.21226787886393889,
        0.5219556305322177,
        0.891562689386263,
        -1.7093246703659977,
        1.8237317984580248]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.33622353496919477,
        -0.21225065886602087,
        0.6697416846893806,
        0.8916900677664332,
        -1.7091699788035828,
        1.8237205195418305]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
       
       
def Third_Carrot_picking():
       
       posCaminus1 =  [-0.40946690468364194,
        -0.2122597511594027,
        0.5187564063679583,
        0.8914295341248326,
        -1.7095029976650826,
        1.8237350975173408]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.3540494214143006,
        -0.2560103478872642,
        0.6693293866209735,
        -0.5636807759566101,
        -1.5290129861639425,
        0.6256004583812227]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
       
        
def First_Appel_picking():
       
       posCaminus1 =  [-0.23363768094748208,
        -0.27975130985189084,
        0.5470409070795529,
        0.6824526265135056,
        -1.7393438409855304,
        1.8359853540915974]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the first Appel
       posCa01 = [-0.2336200049068653,
        -0.2798118194445064,
        0.6637930622999824,
        0.6825985607210331,
        -1.739468618391319,
        1.8361044608608437]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary() 
def Second_Appel_picking():
       
       posCaminus1 =  [-0.34322235633280734,
        -0.28957913880821085,
        0.5365909422258927,
        0.790480647534006,
        -1.6956996495430186,
        1.806295202804724]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second Appel
       posCa01 = [-0.3333920835041708,
        -0.2879919109133574,
        0.6647426813794077,
        0.8102632889573637,
        -1.657783115715506,
        1.8167057277842682]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  
def Third_Appel_picking():
       
       posCaminus1 =  [-0.40380947947219015,
        -0.2895532657819093,
        0.5446187511292365,
        0.7903237262003264,
        -1.6956739834931465,
        1.8062156068648687]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.4037612435985397,
        -0.28958508982476994,
        0.6670233322214016,
        0.7904110579730345,
        -1.6956292149903458,
        1.8063102130743203]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  
        
    
def First_Bannana_picking():
       
       posCaminus1 =  [-0.22699770960605947,
        -0.3799320558717814,
        0.5690242375416242,
        -0.4991294993795321,
        -1.5382713251629299,
        0.6470485826083119]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.19348448493233583,
        -0.3746945735450818,
        0.6717832757252628,
        -0.47737663111492085,
        -1.545753119638913,
        0.672942466240558]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  

def Second_Bannana_picking():
       
       posCaminus1 =  [-0.27388635831371133,
        -0.3747463231976781,
        0.5637683004195567,
        -0.47725737468681256,
        -1.5457732319123891,
        0.6727889746943493]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.27378754117173737,
        -0.37425430772595225,
        0.668718713523517,
        -0.4691853505377986,
        -1.5520019009960775,
        0.6622376464308183]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
def Third_Bannana_picking():
       
       posCaminus1 =  [-0.36861420016794233,
        -0.38383602064774824,
        0.5614136509519088,
        -0.4691014513382586,
        -1.5520339310336853,
        0.6621929431126866]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.3596944224417364,
        -0.3799099649685061,
        0.6678485466919352,
        -0.4912527495359406,
        -1.519848135368884,
        0.7135943878780115]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary() 
    
    


if __name__=='__main__':
    
    
      Fry_Open()
      First_Carrot_picking()
      Fry_close()
      Fry_Open()
      Second_Carrot_picking()
      Fry_close()
      Fry_Open()
      Third_Carrot_picking()
      Fry_close()
      Fry_Open()
      First_Appel_picking()
      Fry_close()
      Fry_Open()
      Second_Appel_picking()
      Fry_close()
      Fry_Open()
      Third_Appel_picking()
      Fry_close()
      Fry_Open()
      First_Bannana_picking()
      Fry_close()
      Fry_Open()
      Second_Bannana_picking()
      Fry_close()
      Fry_Open()
      Third_Bannana_picking()
      Fry_close()

    # Fry_close()s
    #Carrot_picking()
    # close_grioer()
      open_griper()
    
    
    


