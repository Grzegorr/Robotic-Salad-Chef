from pyfirmata import Arduino,SERVO, util
import serial
from subprocess import call
import numpy as np
import rtde_receive
import rtde_control
from time import sleep
import time
import pyfirmata


#import our functions
from FryCutterOpenClose import *








pos = None
pos1 = None
rtde_c = None
rtde_r = None
ardu = None

   

rtde_c = rtde_control.RTDEControlInterface("169.254.141.189")
# import serial library
rtde_r = rtde_receive.RTDEReceiveInterface("169.254.141.189")

ardu = serial.Serial('COM7', 9600)




   
# pos=rtde_r.getActualTCPPose()
#get a position in JOINT SPACE
# pos_j = rtde_r.getActualQ()
# rtde_c.moveJ(PosHj)

# The Home Position for the robot

def Home_pos():
    PosH =[0.3228078180879545,
     0.4075408368142595,
     0.47817282408694783,
     -1.437686088994754,
     0.47144575808011246,
     0.6379876392044342]
    rtde_c.moveL(PosH, 0.1, 0.1)
    
    PosHj=[1.0196882486343384,
     -1.7856414953814905,
     -1.6905539671527308,
     0.4508479833602905,
     2.2006947994232178,
     0.7832316756248474]
    

    #Move in joint position
    rtde_c.moveJ(PosHj)
    
def open_griper():
    command =120    # query servo position
    # write position to serial port
    ardu.write(str(command).encode())
    # read serial port for arduino echo
    reachedPos = str(ardu.readline())
    print(reachedPos)
def close_griper():
    command =60    # query servo position
    # write position to serial port
    ardu.write(str(command).encode())
    # read serial port for arduino echo
    reachedPos = str(ardu.readline())
    print(reachedPos)
    
    


# --------------------------------------------------------------
# -------------------Opening the FryCutter ----------------------
# ..................................................................


def ing_delivary():
    posD01 = [0.24490629655137514,
     0.548428810490081,
     0.4006335106168221,
     -1.6715873471236302,
     0.8168989758234155,
     -1.9130056256272403]
    rtde_c.moveL(posD01, 0.1, 0.1)
    
    posD02 =[0.21462867782488143,
     0.5534235349106671,
     0.4563451131925963,
     -1.6291266090936931,
     0.8203488381579122,
     -1.8292749541410491]
    rtde_c.moveL(posD02, 0.1, 0.1)
    
    open_griper()
    
    posD03 = [0.2922202506157643,
     0.40281992118106213,
     0.40224629950428,
     -1.6491503965614656,
     0.9837880143663791,
     -1.9508065221266504]
    rtde_c.moveL(posD03, 0.1, 0.1)
    
    
     

#  Carrot picking
def First_Carrot_picking_1_1():
    
    #0
    
    
    posCaminus1 =  [0.15259306874630196,
     0.2628014118363295,
     0.46225485781199555,
     -1.80470256629448,
     0.5916533258727816,
     -1.6315713652371373]
    rtde_c.moveL(posCaminus1, 0.1, 0.1)
  
    
    
    open_griper()
    #1 picking the first carrot
    posCa01 = [-0.24766236378363862,
     -0.20070583756851207,
     0.6700391343851001,
     0.9329823804139694,
     -1.7347264182279218,
     1.7209087975102504]
    rtde_c.moveL(posCa01, 0.1, 0.1)
    
    close_griper()
    
    posCa02 = [-0.24765085722884256,
     -0.2006715675131316,
     0.5416518744917878,
     0.933048150430117,
     -1.7346561350780505,
     1.7209780183166001]
    rtde_c.moveL(posCa02, 0.1, 0.1)
    
    posCa03 = [-0.2083130476310146,
     -0.25869170483365356,
     0.4897825002819879,
     -0.6056643336535551,
     -1.515148801314544,
     0.7150208495155058]
    
    rtde_c.moveL(posCa03, 0.1, 0.1)
    ing_delivary()
    
   
    
def Second_Carrot_picking_1_2():
       
       posCaminus1 =  [-0.336234891594495,
        -0.21226787886393889,
        0.5219556305322177,
        0.891562689386263,
        -1.7093246703659977,
        1.8237317984580248]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.33622353496919477,
        -0.21225065886602087,
        0.6697416846893806,
        0.8916900677664332,
        -1.7091699788035828,
        1.8237205195418305]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
       
       
def Third_Carrot_picking():
       
       posCaminus1 =  [-0.40946690468364194,
        -0.2122597511594027,
        0.5187564063679583,
        0.8914295341248326,
        -1.7095029976650826,
        1.8237350975173408]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.3540494214143006,
        -0.2560103478872642,
        0.6693293866209735,
        -0.5636807759566101,
        -1.5290129861639425,
        0.6256004583812227]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
       
        
def First_Appel_picking():
       
       posCaminus1 =  [0.13622724581017567,
        0.2379988134736593,
        0.4518504254832432,
        -1.6909430694890812,
        0.5423653610041956,
        -1.7353626691849386]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the first Appel
       posCa01 = [0.09362679679778793,
        0.264536060100632,
        0.7065929085919198,
        -1.6595581660895438,
        0.6379472452841989,
        -1.8469386510045478]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [0.09361833245982604,
        0.26452399846578883,
        0.4857743298373148,
        -1.6595955254156618,
        0.6378057568306437,
        -1.8470367108986652]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [0.19443851739913676,
        0.35846743140861775,
        0.46329869094798465,
        -1.6671371169833928,
        0.6253473459637443,
        -1.8905589569059649]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary() 
def Second_Appel_picking():
       
       posCaminus1 =  [-0.34322235633280734,
        -0.28957913880821085,
        0.5365909422258927,
        0.790480647534006,
        -1.6956996495430186,
        1.806295202804724]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second Appel
       posCa01 = [-0.3333920835041708,
        -0.2879919109133574,
        0.6647426813794077,
        0.8102632889573637,
        -1.657783115715506,
        1.8167057277842682]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  
        
       posCaminus1 =  [-0.40380947947219015,
        -0.2895532657819093,
        0.5446187511292365,
        0.7903237262003264,
        -1.6956739834931465,
        1.8062156068648687]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.4037612435985397,
        -0.28958508982476994,
        0.6670233322214016,
        0.7904110579730345,
        -1.6956292149903458,
        1.8063102130743203]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  
        
    
def First_Bannana_picking():
       
       posCaminus1 =  [-0.22699770960605947,
        -0.3799320558717814,
        0.5690242375416242,
        -0.4991294993795321,
        -1.5382713251629299,
        0.6470485826083119]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.19348448493233583,
        -0.3746945735450818,
        0.6717832757252628,
        -0.47737663111492085,
        -1.545753119638913,
        0.672942466240558]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  

def Second_Bannana_picking():
       
       posCaminus1 =  [-0.27388635831371133,
        -0.3747463231976781,
        0.5637683004195567,
        -0.47725737468681256,
        -1.5457732319123891,
        0.6727889746943493]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.27378754117173737,
        -0.37425430772595225,
        0.668718713523517,
        -0.4691853505377986,
        -1.5520019009960775,
        0.6622376464308183]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
def Third_Bannana_picking():
       
       posCaminus1 =  [-0.36861420016794233,
        -0.38383602064774824,
        0.5614136509519088,
        -0.4691014513382586,
        -1.5520339310336853,
        0.6621929431126866]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.3596944224417364,
        -0.3799099649685061,
        0.6678485466919352,
        -0.4912527495359406,
        -1.519848135368884,
        0.7135943878780115]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary() 
    
    


if __name__=='__main__':
      Home_pos()
      Fry_Close()
    
    
    


