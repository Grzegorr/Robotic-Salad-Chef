from pyfirmata import Arduino,SERVO, util
import serial
from subprocess import call
import numpy as np
import rtde_receive
import rtde_control
from time import sleep
import time
import pyfirmata
pos = None
pos1 = None
rtde_c = None
rtde_r = None
ardu = None

   

rtde_c = rtde_control.RTDEControlInterface("169.254.141.189")
# import serial library
rtde_r = rtde_receive.RTDEReceiveInterface("169.254.141.189")

ardu = serial.Serial('COM7', 9600)




   
# pos=rtde_r.getActualTCPPose()


# The Home Position for the robot

def Home_pos():
    PosH =[0.27039970411426917,
     0.34763055270328935,
     0.4914470569627832,
     1.7712532082778032,
     0.4873951032452231,
     1.7220631129304518]
    rtde_c.moveL(PosH, 0.1, 0.1)
    
def open_griper():
    command =120    # query servo position
    # write position to serial port
    ardu.write(str(command).encode())
    # read serial port for arduino echo
    reachedPos = str(ardu.readline())
    print(reachedPos)
def close_griper():
    command =60    # query servo position
    # write position to serial port
    ardu.write(str(command).encode())
    # read serial port for arduino echo
    reachedPos = str(ardu.readline())
    print(reachedPos)
    
    


# --------------------------------------------------------------
# -------------------Opening the FryCutter ----------------------
# ..................................................................
def Fry_Open():
    Home_pos()

    # 1.
    pospf01 = [0.2875846437065869,
     0.41947444678749435,
     0.6282449780738184,
     1.7935380521178028,
     0.46417444968804467,
     1.7404491306365018]

    rtde_c.moveL(pospf01, 0.1, 0.1)

# 2.

    pospf02 = [0.2928278495692083,
     0.4584452487701292,
     0.6257660022108006,
     1.6512135808686763,
     0.6238963312061631,
     1.9492171853215992]

    rtde_c.moveL(pospf02, 0.1, 0.1)


# 3.

    pospf03 = [0.29285843789172045,
     0.4584172324582183,
     0.4207177592118692,
     1.6513029125320453,
     0.6236651536704465,
     1.949362211833442]

    rtde_c.moveL(pospf03, 0.1, 0.1)

# 4.

    pospf04 =[0.3003677381220592,
     0.47154001621516684,
     0.44081277872193986,
     1.591552740843503,
     0.6475043217316345,
     1.8740618914229357]

    rtde_c.moveL(pospf04, 0.1, 0.1)


# 5.

    pospf05 = [0.2349359403350353,
     0.47308804397668575,
     0.4733493510760615,
     1.5852833714593033,
     0.8094657756194962,
     1.9855307038726102]
    rtde_c.moveL(pospf05, 0.1, 0.1)

# 6.

    pospf06 = [0.2144743215144771,
     0.4935432772960436,
     0.4733580882665481,
     1.5852848431310427,
     0.809506249880793,
     1.9855766899039768]

    rtde_c.moveL(pospf06, 0.1, 0.1)

# 7.

    pospf07 =[0.22931141172520914,
     0.4739757519756807,
     0.4733464193583668,
     1.585145356352958,
     0.8096928862948259,
     1.9855338644580824]
    rtde_c.moveL(pospf07, 0.1, 0.1)

# 8.

    pospf08 =[0.11362514652401542,
     0.4809396371707009,
     0.44709424608080817,
     1.6707545165979805,
     0.9497581438891485,
     1.9796789630358202]
    rtde_c.moveL(pospf08, 0.1, 0.1)

# 9.

    pospf09 = [0.04224780823828664,
     0.48158493409863523,
     0.4980387823883682,
     1.666602946337069,
     1.0991886104363169,
     1.9613411220287111]
    rtde_c.moveL(pospf09, 0.1, 0.1)


# 10.

    pospf10 = [0.041297632048866106,
     0.48428803680908766,
     0.5238892354684417,
     1.6485273334987736,
     1.1128007466418584,
     1.946837792040326]
    rtde_c.moveL(pospf10, 0.1, 0.1)

# 11.

    pospf11 =[0.04131574903947861,
     0.48428794564891753,
     0.410547447567321,
     1.64859799373051,
     1.1127265584212203,
     1.9469435487749733]
    rtde_c.moveL(pospf11, 0.1, 0.1)

# 12.

    pospf12 = [0.19899361870810178,
     0.371670321782027,
     0.45797346181962884,
     1.7370868556495112,
     0.7376804791741653,
     1.7589223933143268]
    rtde_c.moveL(pospf12, 0.1, 0.1)

    Home_pos()

# --------------------------------------------------------------
# ------------------ Closing  the FryCutter ----------------------
# ..................................................................

def Fry_close():
    close_griper()
    Home_pos()
# 0.

    poscf00 =[0.08410330741334357,
     0.3519939310891966,
     0.616176581180069,
     1.7525519881115657,
     0.9038131961267366,
     2.097946308148322]
    rtde_c.moveL(poscf00, 0.1, 0.1)


# 1.

    poscf01 = [0.036990789778283115,
     0.4688949274631119,
     0.6066496013446475,
     1.6904933757566039,
     0.9728521805309639,
     2.0696258513085204]
    rtde_c.moveL(poscf01, 0.1, 0.1)


# 2.

    poscf02 =[0.03699676199362581,
     0.4688785947328776,
     0.44828634479185997,
     1.690560082776876,
     0.97288769937421,
     2.069584043826298]
    rtde_c.moveL(poscf02, 0.1, 0.1)


# 3.

    poscf03 = [0.13890963894938507,
     0.47130123731599277,
     0.42865833618877364,
     1.6829382590333632,
     0.7754211686944324,
     1.8965423510611072]
    rtde_c.moveL(poscf03, 0.1, 0.1)


# 4.

    poscf04 = [0.23450757574874267,
     0.4940773476511297,
     0.46315292544017717,
     1.742398584865736,
     0.510093834645723,
     1.8195836339100482]
    rtde_c.moveL(poscf04, 0.1, 0.1)

# 5.

    poscf05 = [0.2716152451043157,
     0.49021682744016337,
     0.4824470018331712,
     1.7612982468772747,
     0.40346511573254534,
     1.7969341702794246]
    rtde_c.moveL(poscf05, 0.1, 0.1)

# 6.

    poscf06 = [0.27160503139987624,
     0.49020510614038565,
     0.5082784851893023,
     1.7613050677165687,
     0.4032936888415834,
     1.7970864646907911]
    rtde_c.moveL(poscf06, 0.1, 0.1)

# 7.

    poscf07 =[0.3427902716924291,
     0.5613665412229876,
     0.40895477729296653,
     -3.016392943684365,
     -0.5501825970483325,
     0.11384505173544106]
    rtde_c.moveL(poscf07, 0.1, 0.1)

# 8.

    poscf08 = [0.342765416959207,
     0.561353183158802,
     0.4477555997693912,
     -3.016223900539736,
     -0.5502541504799643,
     0.11367750258462678]
    rtde_c.moveL(poscf08, 0.1, 0.1)
# 9.

    poscf09 = [0.29328708075058885,
     0.4581898182362216,
     0.35331568999303237,
     2.9954500176716983,
     0.5495236662212328,
     -0.2677809734254439]
    rtde_c.moveL(poscf09, 0.1, 0.1)
# 10.

    poscf10 =[0.2893510555089456,
     0.417847048782917,
     0.4657058702478322,
     1.3928657964106061,
     1.0247373259745165,
     1.1223704828968226]
    rtde_c.moveL(poscf10, 0.1, 0.1)
# 11.

    poscf11 =[0.2984919812330183,
     0.38164959960880745,
     0.520655223632495,
     1.6511272222140212,
     0.6856100556590978,
     1.4013468916313456]
    rtde_c.moveL(poscf11, 0.1, 0.1)
    Home_pos()

def ing_delivary():
    posD01 = [0.24490629655137514,
     0.548428810490081,
     0.4006335106168221,
     -1.6715873471236302,
     0.8168989758234155,
     -1.9130056256272403]
    rtde_c.moveL(posD01, 0.1, 0.1)
    
    posD02 =[0.21462867782488143,
     0.5534235349106671,
     0.4563451131925963,
     -1.6291266090936931,
     0.8203488381579122,
     -1.8292749541410491]
    rtde_c.moveL(posD02, 0.1, 0.1)
    
    open_griper()
    
    posD03 = [0.2922202506157643,
     0.40281992118106213,
     0.40224629950428,
     -1.6491503965614656,
     0.9837880143663791,
     -1.9508065221266504]
    rtde_c.moveL(posD03, 0.1, 0.1)
    
    
     

#  Carrot picking
def First_Carrot_picking_1_1():
    
    #0
    
    
    posCaminus1 =  [0.15259306874630196,
     0.2628014118363295,
     0.46225485781199555,
     -1.80470256629448,
     0.5916533258727816,
     -1.6315713652371373]
    rtde_c.moveL(posCaminus1, 0.1, 0.1)
  
    
    
    open_griper()
    #1 picking the first carrot
    posCa01 = [-0.24766236378363862,
     -0.20070583756851207,
     0.6700391343851001,
     0.9329823804139694,
     -1.7347264182279218,
     1.7209087975102504]
    rtde_c.moveL(posCa01, 0.1, 0.1)
    
    close_griper()
    
    posCa02 = [-0.24765085722884256,
     -0.2006715675131316,
     0.5416518744917878,
     0.933048150430117,
     -1.7346561350780505,
     1.7209780183166001]
    rtde_c.moveL(posCa02, 0.1, 0.1)
    
    posCa03 = [-0.2083130476310146,
     -0.25869170483365356,
     0.4897825002819879,
     -0.6056643336535551,
     -1.515148801314544,
     0.7150208495155058]
    
    rtde_c.moveL(posCa03, 0.1, 0.1)
    ing_delivary()
    
   
    
def Second_Carrot_picking_1_2():
       
       posCaminus1 =  [-0.336234891594495,
        -0.21226787886393889,
        0.5219556305322177,
        0.891562689386263,
        -1.7093246703659977,
        1.8237317984580248]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.33622353496919477,
        -0.21225065886602087,
        0.6697416846893806,
        0.8916900677664332,
        -1.7091699788035828,
        1.8237205195418305]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
       
       
def Third_Carrot_picking():
       
       posCaminus1 =  [-0.40946690468364194,
        -0.2122597511594027,
        0.5187564063679583,
        0.8914295341248326,
        -1.7095029976650826,
        1.8237350975173408]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.3540494214143006,
        -0.2560103478872642,
        0.6693293866209735,
        -0.5636807759566101,
        -1.5290129861639425,
        0.6256004583812227]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
       
        
def First_Appel_picking():
       
       posCaminus1 =  [0.13622724581017567,
        0.2379988134736593,
        0.4518504254832432,
        -1.6909430694890812,
        0.5423653610041956,
        -1.7353626691849386]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the first Appel
       posCa01 = [0.09362679679778793,
        0.264536060100632,
        0.7065929085919198,
        -1.6595581660895438,
        0.6379472452841989,
        -1.8469386510045478]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [0.09361833245982604,
        0.26452399846578883,
        0.4857743298373148,
        -1.6595955254156618,
        0.6378057568306437,
        -1.8470367108986652]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [0.19443851739913676,
        0.35846743140861775,
        0.46329869094798465,
        -1.6671371169833928,
        0.6253473459637443,
        -1.8905589569059649]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary() 
def Second_Appel_picking():
       
       posCaminus1 =  [-0.34322235633280734,
        -0.28957913880821085,
        0.5365909422258927,
        0.790480647534006,
        -1.6956996495430186,
        1.806295202804724]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second Appel
       posCa01 = [-0.3333920835041708,
        -0.2879919109133574,
        0.6647426813794077,
        0.8102632889573637,
        -1.657783115715506,
        1.8167057277842682]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  
        
       posCaminus1 =  [-0.40380947947219015,
        -0.2895532657819093,
        0.5446187511292365,
        0.7903237262003264,
        -1.6956739834931465,
        1.8062156068648687]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.4037612435985397,
        -0.28958508982476994,
        0.6670233322214016,
        0.7904110579730345,
        -1.6956292149903458,
        1.8063102130743203]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  
        
    
def First_Bannana_picking():
       
       posCaminus1 =  [-0.22699770960605947,
        -0.3799320558717814,
        0.5690242375416242,
        -0.4991294993795321,
        -1.5382713251629299,
        0.6470485826083119]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.19348448493233583,
        -0.3746945735450818,
        0.6717832757252628,
        -0.47737663111492085,
        -1.545753119638913,
        0.672942466240558]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()  

def Second_Bannana_picking():
       
       posCaminus1 =  [-0.27388635831371133,
        -0.3747463231976781,
        0.5637683004195567,
        -0.47725737468681256,
        -1.5457732319123891,
        0.6727889746943493]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.27378754117173737,
        -0.37425430772595225,
        0.668718713523517,
        -0.4691853505377986,
        -1.5520019009960775,
        0.6622376464308183]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary()
def Third_Bannana_picking():
       
       posCaminus1 =  [-0.36861420016794233,
        -0.38383602064774824,
        0.5614136509519088,
        -0.4691014513382586,
        -1.5520339310336853,
        0.6621929431126866]
       rtde_c.moveL(posCaminus1, 0.1, 0.1)
     
       
       
       open_griper()
       #1 picking the second carrot
       posCa01 = [-0.3596944224417364,
        -0.3799099649685061,
        0.6678485466919352,
        -0.4912527495359406,
        -1.519848135368884,
        0.7135943878780115]
       rtde_c.moveL(posCa01, 0.1, 0.1)
       
       close_griper()
       
       posCa02 = [-0.24765085722884256,
        -0.2006715675131316,
        0.5416518744917878,
        0.933048150430117,
        -1.7346561350780505,
        1.7209780183166001]
       rtde_c.moveL(posCa02, 0.1, 0.1)
       
       posCa03 = [-0.2083130476310146,
        -0.25869170483365356,
        0.4897825002819879,
        -0.6056643336535551,
        -1.515148801314544,
        0.7150208495155058]
       
       rtde_c.moveL(posCa03, 0.1, 0.1)
       ing_delivary() 
    
    


if __name__=='__main__':
    
      Home_pos()
      # Fry_Open()
      # First_Carrot_picking()
      # Fry_close()
      # Fry_Open()
      # Second_Carrot_picking()
      # Fry_close()
      # Fry_Open()
      # Third_Carrot_picking()
      # Fry_close()
      # Fry_Open()
      # First_Appel_picking()
      # Fry_close()
      # Fry_Open()
      # Second_Appel_picking()
      # Fry_close()
      # Fry_Open()
      # Third_Appel_picking()
      # Fry_close()
      # Fry_Open()
      # First_Bannana_picking()
      # Fry_close()
      # Fry_Open()
      # Second_Bannana_picking()
      # Fry_close()
      # Fry_Open()
      # Third_Bannana_picking()
      # Fry_close()

    # Fry_close()s
    #Carrot_picking()
    # close_grioer()
      # open_griper()
    
    
    


